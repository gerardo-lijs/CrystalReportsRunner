<Window
    x:Class="WpfCaller.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:WpfCaller"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="Crystal Reports Runner Sample (WPF .NET 10 app)"
    Width="800"
    Height="450"
    mc:Ignorable="d">

    <Window.Resources>
        <Style TargetType="Button">
            <Setter Property="Padding" Value="10,5" />
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <StackPanel
            Grid.Row="0"
            HorizontalAlignment="Center"
            VerticalAlignment="Center">
            <TextBlock
                Width="500"
                Margin="0,0,0,50"
                FontSize="14"
                TextWrapping="Wrap">
                <Run FontWeight="Bold">Note:</Run>
                <Run>
                    When you click any of the buttons below, a new process (Runner) will be launched that targets .NET Framework 4.8 and Crystal Reports SDK.
                    That process will take care of showing/export the report and communicating the results back. Please make sure:
                </Run>
                <LineBreak />
                <LineBreak />
                <Run>
                    - The database is created using Schema.sql
                </Run>
                <LineBreak />
                <Run>
                    - The connection string is configured in CreateReport() of MainWindow.xaml.cs.
                </Run>
                <LineBreak />
                <Run>
                    - The sample is using the Crystal Reports version you have installed.
                </Run>
            </TextBlock>

            <StackPanel Orientation="Horizontal">

                <Button
                    x:Name="ShowButton"
                    Click="ShowButton_Click"
                    Content="Show Report" />

                <TextBlock Width="20" />

                <Button
                    x:Name="ShowDialogButton"
                    Click="ShowDialogButton_Click"
                    Content="Show Report as a Dialog" />

                <TextBlock Width="20" />

                <Button
                    x:Name="ExportReportButton"
                    Click="ExportReportButton_Click"
                    Content="Export report" />

                <TextBlock Width="20" />

                <Button
                    x:Name="ExportReportToStreamButton"
                    Click="ExportReportToStreamButton_Click"
                    Content="Export report to stream" />
            </StackPanel>

            <StackPanel Margin="0,10,0,0" Orientation="Horizontal">

                <Button
                    x:Name="ShowDataSetButton"
                    Click="ShowDataSetButton_Click"
                    Content="Show DataSet Report" />

                <TextBlock Width="20" />

                <Button
                    x:Name="PrintReportButton"
                    Click="PrintReportButton_Click"
                    Content="Print report" />

            </StackPanel>

            <StackPanel Margin="0,20,0,0" Orientation="Horizontal">
                <CheckBox
                    x:Name="LandscapeCheckBox"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    Content="Landscape mode"
                    ToolTip="Check to request landscape orientation when showing/exporting the report." />

                <!--  Zoom level combobox: 1 = Page Width, 2 = Whole Page, then percentages  -->
                <Label
                    Margin="15,0,0,0"
                    VerticalAlignment="Center"
                    Content="Zoom level:" />
                <ComboBox
                    x:Name="ZoomComboBox"
                    Width="140"
                    VerticalAlignment="Center"
                    SelectedIndex="0"
                    ToolTip="Select zoom level">
                    <ComboBoxItem Tag="1">Page Width</ComboBoxItem>
                    <ComboBoxItem Tag="2">Whole Page</ComboBoxItem>
                    <ComboBoxItem Tag="25">25%</ComboBoxItem>
                    <ComboBoxItem Tag="50">50%</ComboBoxItem>
                    <ComboBoxItem Tag="100">100%</ComboBoxItem>
                    <ComboBoxItem Tag="200">200%</ComboBoxItem>
                    <ComboBoxItem Tag="300">300%</ComboBoxItem>
                </ComboBox>
            </StackPanel>

            <StackPanel Margin="0,20,0,0">
                <CheckBox
                    x:Name="UseWPFViewerCheckBox"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    Content="Use Crystal Reports WPF viewer"
                    ToolTip="Check to use the WPF viewer instead of the WinForms viewer." />
            </StackPanel>

        </StackPanel>

        <StatusBar Grid.Row="1">
            <StatusBarItem>
                <TextBlock x:Name="RuntimesTextBlock" Text="Crystal Reports runtimes: (loading...)" />
            </StatusBarItem>
        </StatusBar>

        <Border
            x:Name="LoadingBorder"
            Grid.RowSpan="2"
            Background="Black"
            Opacity="0.8"
            Visibility="Collapsed" />
    </Grid>
</Window>
